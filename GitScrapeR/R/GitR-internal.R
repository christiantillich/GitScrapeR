.buckets <-
function(x,
  num.switch = class(x) %in% c("numeric", "integer", "float")   
 )
 {
  #If the variable is numeric and the switch is okay,
  if(num.switch){
    
    #Use the histogram function to get the groupings
    groups <- hist(x, plot=F)$breaks
    
    #Use the cute sapply stuff to do the lookup.
    buckets <- sapply(x, function(a) groups[which.min(abs(groups - a))])
    
  }else{
  #If the variable is non-numeric, or the switch has been thrown.
  
    #If the variable has thirty or fewer unique values
    if(length(unique(x)) < 30){
      
      #The groupings are simply unique values as a character vector.
      groups <- unique(x)
      
      #The buckets are simply a character conversion of the vector.
      buckets <- x
      
    }else{
    #If the variable has more than thirty unique values 
  
      #Take the first 29 most frequent values
      n <- table(x)[x %>% table() %>% order(decreasing = T)] %>% head(29) %>% names
      
      #Groupings are those 29 plus "other" category
      groups <- c(n, "Other")
      
      #Buckets are the vector, where the non-grouped are changed to Other.
      buckets <- x; buckets[!buckets %in% n] <- "Other"
    }
  #Return the buckets and the groupings.
  }
  return(list(groups=groups, buckets=buckets))
}
.Random.seed <-
c(403L, 12L, 2103331674L, 436055324L, -2139198433L, 1617023093L, 
1542278412L, 1572282594L, -588355139L, 1831530039L, 1777616094L, 
-1790738408L, -923648133L, 810917657L, 1478206376L, -955329706L, 
-20788271L, -1958895741L, -837228014L, -1166762588L, -1778603673L, 
2013951677L, 1329159732L, 862520730L, -3563035L, -1340600961L, 
813475078L, 865156752L, 2127066931L, 1970947281L, -2029814144L, 
-1437563042L, -1087724375L, -689727653L, 715697514L, -2058543092L, 
-1797531569L, 1321718021L, -1395004996L, 1012661394L, 1524795277L, 
-1969127481L, -943119186L, 592610568L, -93867253L, -1705009687L, 
-1950946632L, -802575002L, 1489724929L, -1639313261L, -823006398L, 
1060480244L, 1910280439L, -740407059L, -349901948L, 994452906L, 
1232255765L, 1742514607L, -1359320650L, 1345277920L, 884023075L, 
-225701823L, -1116452048L, 1728725326L, 383267769L, 47392203L, 
-1365879174L, -407807108L, 1168569279L, 172596373L, 1254285996L, 
574521474L, 875384925L, -1639110825L, 662624830L, 1157197432L, 
1965247835L, 1033829561L, -902277880L, 1574524854L, -767869711L, 
-1997284573L, -1554080398L, -925141052L, 957125511L, -1432436387L, 
-423674028L, 1054590330L, -194117435L, 202932767L, -459881050L, 
-1412569296L, 1900735955L, 1739938801L, -829383392L, 1743027134L, 
611087305L, 923255675L, -776216246L, 389934508L, 310433967L, 
2062410341L, 296819228L, -1995942798L, 1390643949L, -567240921L, 
-1319218354L, -1473225816L, -1927471189L, -18944823L, 888159448L, 
2111439238L, 1628018785L, 1343166963L, -775485342L, 98549460L, 
-1283282985L, -2094910003L, 1771229540L, -574646966L, 1142232245L, 
1831384079L, 2122059030L, 640808896L, 360096643L, 1987858849L, 
235650448L, -1607627154L, 524449817L, -2115066709L, -483100518L, 
-1392187300L, 1365271903L, 1389817653L, -1093524788L, 1928912930L, 
-149312899L, -1987788937L, -279793506L, 1385967448L, 1694890683L, 
-1211136935L, 369319912L, 1273629206L, 878169489L, 939202115L, 
931669330L, 1342720484L, 1086990375L, -1249233795L, 76675444L, 
200947034L, 1821983653L, 2080977855L, -646217658L, 1270107856L, 
149797107L, -132346351L, -2110613440L, 245763102L, -1034212631L, 
2078593051L, 1539627050L, -596620468L, 651208975L, -1077601211L, 
1864785404L, -1732211630L, 72895949L, -1215606905L, -511514002L, 
-1986360760L, -139797429L, -1346962007L, -944148232L, -1539640282L, 
-419400383L, 1516798675L, 1648102018L, 823111860L, -51453897L, 
890139437L, -76715964L, -1844718230L, 143065557L, 776337263L, 
-392581514L, 78406048L, 1416914531L, -963674367L, -280965520L, 
502016526L, 625599097L, 284503563L, 1930018618L, 1205601852L, 
1323576703L, -2074607915L, -74690836L, -1193344958L, -1386862691L, 
581907991L, -1387426946L, -1668740808L, 120022555L, -1715918983L, 
1623318984L, 1855438326L, -1822302159L, -155923869L, 1736283698L, 
317973380L, -1071414841L, 1342367901L, 267919380L, -311789894L, 
-874354939L, -1788394273L, 1822287206L, -837201680L, 1321227283L, 
-456959567L, 1408054368L, -1440595458L, 1265370505L, -407551301L, 
-273846646L, 1069828460L, -1198100753L, -1527492800L, 1673782452L, 
238051144L, 1540100794L, -583172336L, 478086380L, 1052855380L, 
458632978L, -937001056L, -1090976820L, 1360780128L, 181847234L, 
-1549353432L, -173539924L, 1880959804L, -577906830L, 1893728048L, 
-389556700L, 1394404408L, 1871636698L, -1181418096L, 1874877180L, 
169771924L, -1406017726L, -703371776L, 151154236L, -1803775408L, 
647888546L, 829483848L, -1043930612L, 163862748L, -1894180270L, 
-1602914176L, -1737071788L, 602607080L, 1259278074L, 1089145680L, 
1414007852L, -939173516L, -1344743790L, 1201372768L, 1989367436L, 
1947670368L, -1565154590L, 1701662888L, -1502470964L, -522243588L, 
-45201486L, 1308502512L, 335943108L, -1052740776L, -1263906950L, 
835708336L, 1471905212L, -334189484L, 1298231234L, 344635168L, 
1669120956L, -908214704L, -130516510L, 1090790760L, 613733708L, 
-934142724L, 1201406706L, 453487360L, -1427419532L, -980255736L, 
1234569658L, -1710847024L, 2072352236L, -579772524L, -555053358L, 
-1927943584L, 1884067148L, -1031524064L, 1632716418L, 171492840L, 
1220402156L, 1137539644L, -732977550L, 1757961072L, -1559193308L, 
-1135900104L, -899954278L, 2008460752L, 1691971004L, 840926356L, 
1548767362L, 838981056L, -713341124L, -1238853488L, 714140450L, 
912548360L, 821518604L, -1338136164L, 311040530L, 1756970880L, 
154882836L, -1438222040L, 1624244282L, -2099924016L, -1478375828L, 
-1267158476L, -249407854L, 1338420576L, -1179475636L, 1938936800L, 
-1524555358L, -1689755224L, 1219870348L, -835168836L, 1147904626L, 
629083120L, 1194834500L, 169664600L, -1176398790L, -280798096L, 
-614808516L, -1591304940L, 1543389890L, -1408387360L, 110722172L, 
-843947312L, 1920713122L, -77433816L, -692947188L, -1855167044L, 
-273938638L, 729288384L, -173430732L, -2029973816L, 1106847930L, 
909017744L, 1731430124L, 16175700L, -733852014L, 304567584L, 
2039021004L, -1660981536L, -1517683518L, -534602712L, 432227244L, 
-2133391684L, 1467090930L, -1143295440L, 1157348260L, -2061195848L, 
-416159910L, -1060022128L, 657155964L, -480164588L, 847053122L, 
1825807616L, 1486946748L, -1117774512L, -969242334L, 1631482440L, 
1180122124L, 66450012L, 589125074L, -1280819712L, -1597386412L, 
-1739356952L, -1597744902L, -1620159792L, -900980948L, -857899788L, 
-933530222L, 508348768L, -1077082100L, 1498851552L, -287750558L, 
276590760L, -653797300L, 1873753980L, 131988786L, -1165857168L, 
1297352516L, 1348414424L, 519565178L, 575423536L, -923172932L, 
-2141578668L, 594112578L, 656643744L, 21269180L, -1209243696L, 
-155031198L, 403213032L, 1465816268L, -1613379076L, 1976259058L, 
-1786507136L, 2018233844L, -96220536L, -676747462L, 1705695568L, 
-947513236L, 1822303636L, 748006482L, 1296904672L, -2101477172L, 
-1717073248L, -1996574334L, -1238305560L, 817945324L, 1765454140L, 
-1732064142L, -963142032L, 460895780L, 346521656L, 1070208282L, 
-525766448L, -618713796L, 1070387092L, -1167280254L, -824193088L, 
-787083716L, -1843158640L, -1853103070L, -795426552L, -1531779956L, 
-1245056228L, -1087844206L, 2120663424L, 1937218580L, 1120917288L, 
-897103777L, -363654472L, 40676246L, -1854277213L, -1792053915L, 
-1230369662L, 2103322096L, -352947303L, -943950453L, 1022943356L, 
574104234L, -1835647777L, -655353239L, 1649842302L, 1928585324L, 
1079949501L, 497682823L, 1786494320L, 697927694L, -1315199685L, 
-813004259L, -1395913014L, 812263912L, 1403633361L, -604529981L, 
-1375891004L, -1454737806L, -851892409L, 1339184913L, 821299862L, 
1287516148L, 1375541637L, -1327614769L, 421907912L, 1546593382L, 
-1111965037L, 847882741L, -257743918L, -1250297824L, 1149374985L, 
933784379L, -373072244L, 995750682L, 335295887L, 1468926681L, 
425887086L, -1003673348L, 509997677L, 1471327767L, -149410848L, 
-116475970L, 911975819L, 1539307021L, -825316806L, -2045746568L, 
-1508603359L, 1952933075L, -1134730252L, -594754430L, 1367264535L, 
1776147425L, -1164268250L, -1996002268L, -966072619L, 1509196415L, 
749818648L, -1339504074L, -392319805L, -2109816571L, -382166878L, 
-976490864L, 1046661689L, -2117381397L, -16256036L, -1644161526L, 
-1968994049L, 1133571401L, -1074995490L, 1640776844L, 77149277L, 
961604199L, 860017552L, -1430849618L, 1453807195L, 767191613L, 
-142476118L, 1202998600L, -118214287L, 1227790051L, 1108835812L, 
-1650134766L, -1714008857L, 1487616689L, -1245994762L, -40981740L, 
-645708763L, 456106287L, -2073487640L, -1976900666L, -1407412621L, 
-934627115L, 1629053618L, -331535744L, 2031782505L, 1789812443L, 
496810540L, 1778258490L, 639229167L, -1585877127L, -194546674L, 
-323982884L, -1813370291L, 836336055L, -1319037120L, 430009886L, 
1570986219L, -163329939L, 592142554L, -93126504L, -655509759L, 
-478610253L, -7047212L, -1490955550L, -1558457481L, -714293567L, 
1656067654L, -57538172L, 450311989L, 1570350367L, 2028924024L, 
-1895507626L, -1999685661L, 1452040613L, -183135166L, 1979681328L, 
1192632921L, 1304073163L, -69372868L, -2109547926L, 1210046623L, 
-450326231L, -662862402L, -1004268372L, -1361382915L, -1323599545L, 
-502730192L, -2069998770L, 1711347579L, -2121916195L, -1034426102L, 
-309392344L, -1129250671L, 442004611L, -1279191676L, -294431822L, 
1332452615L, 1796876113L, -1814239530L, 408313780L, -1512378427L, 
-1266127089L, 332189064L, -1830688602L, 895637587L, -1474199115L, 
2135541522L, -785609504L, 626098505L, 1493564283L, -1050530399L
)
